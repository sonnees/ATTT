<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ATTT hàm Băm-Chữ ký số</title>
    <link rel="shortcut icon" href="../image/sonnees.png" />
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <script src="../js/jquery-3.6.1.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="../css/div.css">
    <script src="../js/attt.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
</head>

<body style="background-color: #efefef;">
    <div class="container" style="width: 61%; height: 1500px;">
        <div class="div" style=" height: 150px">
            <h4 style="text-align: center;">AN TOÀN THÔNG TIN </h4>
            <li style="list-style-type: none;"><i>Hướng dẫn:</i> TS. Ngô Hữu Dũng</li>
            <li style="list-style-type: none;"><i>Bài làm:</i> Nguyễn Văn Sơn</li>
        </div>
        <div class="div" style=" height: 380px;">
            <h5>1. Hàm băm CRC32</h5>
            <ul>
                <li>Tính toán nhanh: CRC32 là một thuật toán tính toán nhanh, phổ biến trong các ứng dụng yêu cầu tốc độ xử lý cao.</li>
                <li>Chu kỳ ngắn: CRC32 có chu kỳ ngắn, giúp phát hiện và phân biệt các lỗi trong dữ liệu nhanh chóng.</li>
                <li>Không đảo ngược: Không thể đảo ngược để phục hồi lại dữ liệu gốc từ giá trị băm CRC32.</li>
                <li>Đơn chiều: CRC32 là một hàm băm đơn chiều, chỉ được sử dụng để so sánh giá trị băm của dữ liệu gốc với giá trị băm của dữ liệu sau khi được xử lý.</li>
            </ul>
            <div class="container mt-5" style="width: 50%;">
                <form>
                    <div class="form-group">
                        <div class="input-group">
                            <input type="text" class="form-control" id="inputCRC32" placeholder="Nhập mật khẩu">
                            <div class="input-group-append">
                                <button class="btn btn-outline-success" type="button" id="CRC32">CRC32</button>
                            </div>
                        </div>
                    </div>
                    <input type="text" class="form-control" id="passwordHashCRC32" placeholder="Mật khẩu băm sẽ hiện ở đây">
                </form>

            </div>
        </div>
        <div class="div" style=" height: 330px;">
            <h5>2. Hàm băm SHA-1</h5>
            <ul>
                <li>Độ dài đầu ra cố định: Giá trị băm SHA-1 có độ dài cố định là 160 bit (20 byte).</li>
                <li>Li độ tin cậy: SHA-1 được coi là đáng tin cậy trong quá khứ, nhưng hiện nay đã không được khuyến cáo sử dụng do các lỗ hổng bảo mật đã được phát hiện và không an toàn trong một số trường hợp.</li>
            </ul>
            <div class="container mt-5" style="width: 70%;">

                <form>
                    <div class="form-group">
                        <div class="input-group">
                            <input type="text" class="form-control" id="inputSHA-1" placeholder="Nhập mật khẩu">
                            <div class="input-group-append">
                                <button class="btn btn-outline-success" type="button" id="SHA-1">SHA-1</button>
                            </div>
                        </div>

                    </div>
                    <div class="input-group">
                        <input type="text" class="form-control" id="passwordHashSHA-1" placeholder="Mật khẩu băm sẽ hiện ở đây">
                    </div>
                    <div style="margin-top: 5px;"></div>
                    <div class="input-group">
                        <input type="text" class="form-control" id="passwordHashSHA-1Length" placeholder="Độ dài của kết quả băm sẽ hiện ở đây ">
                    </div>
                </form>
            </div>
        </div>

        <div class="div" style=" height: 390px;">
            <h5>3. Hàm băm MD5</h5>
            <ul>
                <li>Độ dài đầu ra cố định: Giá trị băm MD5 có độ dài cố định là 128 bit (16 byte).</li>
                <li>Tính đa dạng: MD5 cho kết quả băm có tính đa dạng, nghĩa là những thay đổi nhỏ trong dữ liệu gốc sẽ tạo ra giá trị băm khác nhau.</li>
                <li>Đã không được khuyến cáo: MD5 cũng không được khuyến cáo sử dụng trong các ứng dụng an ninh, do đã được chứng minh là không an toàn và dễ bị tấn công bằng các phương pháp va chạm (collision attacks).</li>
            </ul>
            <div class="container mt-5" style="width: 70%;">

                <form>
                    <div class="form-group">
                        <div class="input-group">
                            <input type="text" class="form-control" id="inputMD5" placeholder="Nhập mật khẩu">
                            <div class="input-group-append">
                                <button class="btn btn-outline-success" type="button" id="MD5">MD5</button>
                            </div>
                        </div>
                    </div>
                    <input type="text" class="form-control" id="passwordHashMD5" placeholder="Mật khẩu băm sẽ hiện ở đây">
                </form>
                <div style="margin-top: 5px;"></div>
                <div class="input-group">
                    <input type="text" class="form-control" id="passwordHashMD5Length" placeholder="Độ dài của kết quả băm sẽ hiện ở đây ">
                </div>
            </div>
        </div>

        <div class="div" style=" height: 390px;">
            <h5>4. Chữ ký số RSA</h5>

            <div class="container mt-5" style="width: 70%;">

                <form>
                    <div class="form-group">
                        <div class="input-group">
                            <input type="text" class="form-control" id="inputRSA" placeholder="Nhập mật khẩu">
                        </div>
                        <div style="margin-top: 5px;"></div>
                        <div class="input-group">
                            <input type="text" class="form-control" id="inputRSA_P" placeholder="Nhấp nút 'Tạo khóa riêng' để tạo privateKey " disabled>
                            <div class="input-group-append">
                                <button class="btn btn-outline-success" type="button" id="privateKey">Tạo khóa riêng</button>
                            </div>
                        </div>
                    </div>
                    <input type="text" class="form-control" id="passwordHashRSA" placeholder="Chữ ký số sẽ xuất hiện ở đây">
                </form>
                <div style="margin-top: 5px;"></div>

            </div>
        </div>
    </div>
    <script>
        // hàm băm mật khẩu crc32
        document.getElementById("CRC32").addEventListener("click", function() {

            function crc32(str) {
                let crc = 0xFFFFFFFF;
                for (let i = 0; i < str.length; i++) {
                    const c = str.charCodeAt(i) & 0xFF;
                    crc ^= c;
                    for (let j = 0; j < 8; j++) {
                        if (crc & 1) {
                            crc = (crc >>> 1) ^ 0xEDB88320;
                        } else {
                            crc >>>= 1;
                        }
                    }
                }
                return (crc ^ 0xFFFFFFFF) >>> 0;
            }
            var password = document.getElementById("inputCRC32").value;

            const hashValue = crc32(password).toString(16).toUpperCase();
            document.getElementById("passwordHashCRC32").value = hashValue;
        });

        document.getElementById("SHA-1").addEventListener("click", function() {
            var password = document.getElementById("inputSHA-1").value;
            const hash = CryptoJS.SHA1(password);
            const hash_value = hash.toString(CryptoJS.enc.Hex);
            document.getElementById("passwordHashSHA-1").value = hash_value;
            document.getElementById("passwordHashSHA-1Length").value = "Độ dài của kết quả băm (tính bằng bit, length * 4): " + hash_value.length * 4;
        });
        document.getElementById("MD5").addEventListener("click", function() {
            var password = document.getElementById("inputMD5").value;
            const hash = CryptoJS.MD5(password);
            const hash_value = hash.toString(CryptoJS.enc.Hex);
            document.getElementById("passwordHashMD5").value = hash_value;
            document.getElementById("passwordHashMD5Length").value = "Độ dài của kết quả băm (tính bằng bit, length * 4): " + hash_value.length * 4;
        });

        document.getElementById("privateKey").addEventListener("click", function() {

        });

        document.getElementById("RSA").addEventListener("click", function() {
            async function test() {

                const data = new TextEncoder().encode(document.getElementById("inputRSA").value);

                const privateKey = document.getElementById("inputRSA_P").value;

                const signature = await window.crypto.subtle.sign({
                    name: 'RSASSA-PKCS1-v1_5',
                    hash: 'SHA-256'
                }, privateKey, data); // Tạo chữ ký số


                return signature;
            }
            document.getElementById("passwordHashRSA").value = test().then(result => alert(result))
                .catch(error => alert(error));
        });
    </script>
</body>

</html>